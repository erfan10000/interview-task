<div class="event-list-container">
  <nz-row [nzGutter]="16">
    <nz-col [nzMd]="12" [nzLg]="10" [nzXs]="24">
      <nz-input-group [nzPrefix]="'Search'">
        <input nz-input placeholder="Search by title" [(ngModel)]="searchTerm" (ngModelChange)="onSearch()" />
      </nz-input-group>
      <div class="spacer"></div>
    </nz-col>
    <nz-col [nzMd]="8" [nzLg]="10" [nzXs]="24">
      <nz-select [(ngModel)]="filterPublic" (ngModelChange)="onFilterChange($event)" nzPlaceHolder="Filter by Public/Private">
        <nz-option [nzValue]="null" nzLabel="All"></nz-option>
        <nz-option [nzValue]="true" nzLabel="Public"></nz-option>
        <nz-option [nzValue]="false" nzLabel="Private"></nz-option>
      </nz-select>
       
      <div class="spacer"></div>
    </nz-col>
    <nz-col [nzMd]="1" [nzXs]="24">
      <div class="seprator">
        <button button nz-button nzType="primary" (click)="createEvent()" style="margin-bottom: 16px;">Create</button>
      </div>
    </nz-col>
  </nz-row>
  
 
  
  <nz-table #eventTable [nzData]="filteredEvents" [nzLoading]="isLoading">
    <thead>
      <tr>
        <th>Title</th>
        <th (click)="toggleSort()" class="date-th">
          <span>

            Date
          </span>
          <span nz-icon [nzType]="sortDirection === 'ascend' ? 'arrow-up' : 'arrow-down'" ></span>
        </th>
        <th>Venue</th>
        <th>Public</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let event of filteredEvents">
        <td>{{ event.title }}</td>
        <td>{{ event.startDateTime | date:'medium' }}</td>
        <td>{{ event.venue.venueName }}</td>
        <td>{{ event.isPublic ? 'Yes' : 'No' }}</td>
        <td>
          <div class="action-buttons">

            <div class="edit-btn">

              <button nz-button (click)="editEvent(event.id)" nzType="default">
                Edit
              </button>
            </div>
            <button nz-button nz-dropdown [nzDropdownMenu]="menu" nzType="default">
              <span nz-icon nzType="more"></span>
            </button>
          </div>

          <nz-dropdown-menu #menu="nzDropdownMenu">
            <ul nz-menu>
              <li nz-menu-item (click)="editEvent(event.id)">Edit</li>
              <li nz-menu-item (click)="deleteEvent(event.id)">Delete</li>
              <li nz-menu-item *ngIf="event.isPublic" (click)="copyPublicLink(event.id)">
                <span nz-icon nzType="link"></span> Copy Link
              </li>
              <li nz-menu-item *ngIf="event.isPublic" (click)="showShareModal(event.id)">
                <span nz-icon nzType="share-alt"></span> Share
              </li>
            </ul>
          </nz-dropdown-menu>
        </td>
      </tr>
      
    </tbody>
    
  </nz-table>
  <!-- <div *ngIf="!isLoading && filteredEvents.length === 0">No events found.</div> -->
</div>

<nz-modal
  [(nzVisible)]="isShareModalVisible"
  nzTitle="Share Event"
  [nzFooter]="null"
  (nzOnCancel)="handleShareModalCancel()"
  [nzContent]="shareModalContent"
>
</nz-modal>

<ng-template #shareModalContent>
  <div>
    <p>Share this event with others:</p>
    <nz-input-group>
      <input nz-input [value]="shareUrl" readonly />
    </nz-input-group>
    <div style="margin-top: 16px;">
      <button nz-button nzType="default" (click)="copyPublicLink(shareUrl)" style="margin-right: 8px;">
        <span nz-icon nzType="copy"></span> Copy Link
      </button>
      <button nz-button nzType="primary" nz-dropdown [nzDropdownMenu]="socialMenu" style="margin-right: 8px;">
        <span nz-icon nzType="share-alt"></span> Share via...
      </button>
      <nz-dropdown-menu #socialMenu="nzDropdownMenu">
        <ul nz-menu>
          <li nz-menu-item (click)="shareOnSocial('facebook')">
            <span nz-icon nzType="facebook"></span> Facebook
          </li>
          <li nz-menu-item (click)="shareOnSocial('twitter')">
            <span nz-icon nzType="twitter"></span> Twitter
          </li>
        </ul>
      </nz-dropdown-menu>
    </div>
  </div>
</ng-template>